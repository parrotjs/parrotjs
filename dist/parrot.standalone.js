/**
 * parrotjs - Use browser features (Notification, Storage, Vibration, Battery...) and make easy the communication with your API.
 * @version v0.11.27a
 * @link    http://github.com/sailor/parrotjs
 * @author  Kiko Beats (https://github.com/Kikobeats)
 * @license MIT
 */
(function(){"use strict";var e;e=this.parrot={version:"0.12.8beta",$:"undefined"!=typeof $$&&null!==$$?$$:$,_partial:function(e){var t;return t=Array.prototype.slice.call(arguments,1),function(){var n;return n=t.concat(Array.prototype.slice.call(arguments)),e.apply(this,n)}}},function(){var t,n;return t={},n=function(e){var t,n,r,o,u,i,a,s,l,c;for(u=new Url,c=["protocol","path","host","port","hash"],i=0,s=c.length;s>i;i++)n=c[i],u[n]="";for(t=a=0,l=e.length;l>a;t=a+=2)r=e[t],u.query[r]=e[t+1];return o=u.toString(),"?"===o.charAt(0)&&(o=o.substring(1)),o},e.environment="development",e.language=window.navigator.language.slice(0,2),e.endpoint={add:function(e){return this[e.name]=function(){return e.url},this},set:function(t){return e.environment=t,this}},e.url={getOrUpdate:function(e,r){var o;if(null==r&&(r=void 0),null!=r){for(o in r)t[e][o]=r[o];null!=r.query&&(t[e].query=n(r.query))}return t[e]},add:function(r){var o;return o=r.name,delete r.name,null!=r.query&&(r.query=n(r.query)),t[o]=r,this[o]=e._partial(this.getOrUpdate,o),this}}}(),function(){return e.ajax=function(t,n){var r,o,u,i,a;return r=function(t){var n;return n={METHOD:"get",SEND:{},HEADERS:{},ASYNC:!0,DATATYPE:"json",CONTENT_TYPE:"application/x-www-form-urlencoded"},new Promise(function(r,o){return e.$.ajax({url:t.url,type:t.method||n.METHOD,data:t.send||n.SEND,dataType:t.dataType||n.DATATYPE,contentType:t.contentType||n.CONTENT_TYPE,async:t.async||n.ASYNC,headers:t.headers||n.HEADERS,success:function(e){return 0===e.status?o({code:0,message:{errors:[{param:"url",msg:"Server Unavailable."}]}}):r(e)},error:function(e,t){var n;if(t="object"==typeof e?e:t,null!=t.responseJSON)n=t.responseJSON;else try{n=JSON.parse(t.response)}catch(r){n=t.response}return o({code:t.status,message:n})}})})},o=function(e,t){return r(e).then(function(e){return t(null,e)},function(e){return t(e,null)})},u=""+e.endpoint[e.environment](),t.url?t.url!==u&&t.url!==""+u+"/"+t.path&&t.url!==""+u+"?"+t.query&&t.url!==""+u+"/"+t.path+"?"+t.query&&(null!=t.path&&(t.url=""+t.url+"/"+t.path),null!=t.query&&(t.url=""+t.url+"?"+t.query)):("string"==typeof arguments[0]&&(null!=("function"==typeof(i=e.url)[a=arguments[0]]?i[a]():void 0)?t=e.url.getOrUpdate(arguments[0],arguments[1]):"object"==typeof arguments[1]?(t=arguments[1],t.url=arguments[0]):t={url:arguments[0]},"object"==typeof arguments[1]&&(n=arguments[2])),t.query&&t.path?t.url=""+u+"/"+t.path+"?"+t.query:(t.query&&!t.path&&(t.url=""+u+"?"+t.query),t.path&&!t.query&&(t.url=""+u+"/"+t.path))),o(t,n)}}(),function(){var t,n,r,o,u,i,a,s;return r=function(){var t,r,o,u,i,a,s,l;for(a=Object.keys(localStorage),r=0,u=a.length;u>r;r++)t=a[r],e.local[t]=e._partial(n,"local",t);for(s=Object.keys(sessionStorage),l=[],o=0,i=s.length;i>o;o++)t=s[o],l.push(e.session[t]=e._partial(n,"session",t));return l}(),s=function(e){return"local"===e?localStorage:sessionStorage},n=function(e,t){var n,r;n=s(e).getItem(t);try{return n=JSON.parse(n)}catch(o){return r=o,n}},t=function(t,r,o){return"string"!=typeof o&&(o=JSON.stringify(o)),s(t).setItem(r,o),e[t][r]=e._partial(n,t,r)},u=function(t,n){return delete e[t][n],s(t).removeItem(n)},i=function(t){var n,r,o,u;for(r=Object.keys(s(t)),o=0,u=r.length;u>o;o++)n=r[o],delete e[t][n];return s(t).clear()},a=function(e){return s(e).length},o=function(e,t){return null!=s(e)[t]},e.local={add:function(e,n){return t("local",e,n),this},remove:function(){var e,t,n;for(t=0,n=arguments.length;n>t;t++)e=arguments[t],u("local",e);return this},removeAll:function(){return i("local"),this},size:function(){return a("local")},isAvailable:function(e){return o("local",e)}},e.session={get:function(){return n("session","session")},add:function(){var e,n;return 1===arguments.length?(n="session",e=arguments[0]):(n=arguments[0],e=arguments[1]),t("session",n,e),this},remove:function(){var e,t,n;if(0===arguments.length)u("session","session");else for(t=0,n=arguments.length;n>t;t++)e=arguments[t],u("session",e);return this},removeAll:function(){return i("session"),this},size:function(){return a("session")},isAvailable:function(){var e;return e=0===arguments.length?"session":arguments[0],o("session",e)}}}(),function(){var t;return t={},e.notification={getOrUpdate:function(e,n){var r;if(null==n&&(n=void 0),null!=n)for(r in n)t[e][r]=n[r];return t[e]},add:function(n){var r;return r=n.name,delete n.name,t[r]=n,this[r]=e._partial(this.getOrUpdate,r),this},show:function(e,t){var n,r;return 1===arguments.length&&"object"==typeof e&&(e=void 0,t=arguments[0]),r=function(){return function(e){var t,n;try{return window.Notification.requestPermission(),n=e.title,delete e.title,new Notification(n,e)}catch(r){throw t=r,new Error("Notification API is not available.")}}}(this),null==e?r(t):(n=this.getOrUpdate(e,t),r(n))}}}(),function(){return e.device={detection:function(){return e.$(document.body).attr("data-lang",e.language),e.$(document.body).attr("data-os",this.os.name.toLowerCase()),e.$(document.body).attr("data-device",this.type),e.$(document.body).attr("data-orientation",this.screen.orientation),e.$(document.body).attr("data-screen",this.screen.size),e.$(document.body).attr("data-retina",1===this.screen.pixelRatio?!1:!0)},noDetection:function(){var t,n,r,o,u;for(o=["lang","os","device","orientation","screen","retina"],u=[],n=0,r=o.length;r>n;n++)t=o[n],u.push(e.$(document.body).removeAttr("data-"+t));return u}}}(),e.$(function(){var t;return t=function(){var t,n,r,o,u,i,a,s,l,c,d;l=e.device.detection,d=e.device.noDetection,u=function(e,t){var n,r,o;return r=function(e,t){return 0===t?e:r(t,e%t)},e===t?"1/1":(t>e&&(o=e,e=t,t=o),n=r(e,t),"undefined"==typeof o?e/n+"/"+t/n:t/n+"/"+e/n)},r=(new UAParser).getResult(),delete r.ua,null!=r.cpu.architecture&&(r.cpu=r.cpu.architecture),delete r.cpu,c=r.device,delete r.device;for(o in c)a=c[o],null!=a&&(r[o]=a);return e.device=r,s=screen.width,t=screen.height,i=t>s&&480>s||s>t&&480>t?"small":"normal",n=1>t/s?"landscape":"portrait",e.device.screen={width:s,height:t,size:i,orientation:n,pixelRatio:window.devicePixelRatio||"unsupported",aspectRatio:u(s,t)},null==e.device.type&&"normal"===i&&(e.device.type="desktop"),e.device.detection=l,e.device.noDetection=d}(),e.device.detection(),e.$(window).on("resize",t),e.$(window).on("orientationchange",t)})}).call(this);